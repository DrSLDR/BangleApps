var locale=require("locale");const big=g.getWidth()>200,timeFontSize=big?4:3,dateFontSize=big?3:2,smallFontSize=big?2:1,font="6x8",xyCenter=g.getWidth()/2,yposTime=50,yposDate=big?85:75,yposTst=big?115:95,yposDml=big?170:130,yposDayMonth=big?195:140,yposGMT=big?220:150,moonPeriod=29.53,moonTime=[.5,6.8825,7.8825,14.265,15.265,21.6475,22.6475,29.03];var is12Hour=(require("Storage").readJSON("setting.json",1)||{})["12hour"];function getUTCTime(e){return e.toUTCString().split(" ")[4].split(":").map((function(e){return Number(e)}))}function getWeekNumber(e){e=new Date(e-60*e.getTimezoneOffset()*1e3),(e=new Date(e.getFullYear(),e.getMonth(),e.getDate())).setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function drawSimpleClock(){var e=new Date,t=e.toString().split(" ");getUTCTime(e);g.reset(),g.setFontAlign(0,0);var o=t[4].split(":"),n=o[0],i=o[1],r=o[2],a="";is12Hour&&(a="AM",0==(n=parseInt(n,10))?(n=12,a="AM"):n>=12&&(a="PM",n>12&&(n-=12)),n=(" "+n).substr(-2)),g.setFont(font,timeFontSize),g.drawString(`${n}:${i}:${r}`,xyCenter,50,!0),g.setFont(font,smallFontSize),g.drawString(a,xyCenter+102,60,!0);var m=e.getMonth()+1,l=m.toString();m<10&&(l="0"+l);var s=e.getDate(),T=s.toString();s<10&&(T="0"+T),g.setFont(font,dateFontSize),g.drawString(`${e.getFullYear()}-${l}-${T}`,xyCenter,yposDate,!0);var S=Math.floor(e.getTime()/1e3);g.setFont(font,smallFontSize),g.drawString(`tst:${S}`,xyCenter,yposTst,!0);var w=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();g.setFont(font,smallFontSize),g.drawString(`d:${locale.dow(e,!0)} md:${w} w:${getWeekNumber(e)}`,xyCenter,yposDml,!0);var d=new Date(2020,2,24,9,28,0),u=(e.getTime()-d.getTime())/1e3/60/60/24/29.53%1*29.53,y="new";u>moonTime[0]&&u<=moonTime[1]?y="wx.cr":u>moonTime[1]&&u<=moonTime[2]?y="fst.q":u>moonTime[2]&&u<=moonTime[3]?y="wx.gb":u>moonTime[3]&&u<=moonTime[4]?y="full":u>moonTime[4]&&u<=moonTime[5]?y="wn.gb":u>moonTime[5]&&u<=moonTime[6]?y="lst.q":u>moonTime[6]&&u<=moonTime[7]&&(y="wn.cr"),g.setFont(font,smallFontSize),g.drawString(`m:${y}`,xyCenter,yposDayMonth,!0);var F=t[5];g.setFont(font,smallFontSize),g.drawString(F,xyCenter,yposGMT,!0)}Bangle.on("lcdPower",(function(e){e&&drawSimpleClock()})),g.clear(),Bangle.setUI("clock"),Bangle.loadWidgets(),Bangle.drawWidgets(),setInterval(drawSimpleClock,500),drawSimpleClock();
